{"ast":null,"code":"var _jsxFileName = \"/Users/pie_trick/Desktop/Semester3/Dublin-Bus-Time/frontend/src/App.js\";\nimport React, { Component, useState, useEffect, useRef } from 'react';\nimport { Button, ButtonGroup } from \"reactstrap\";\nimport { debounce } from 'lodash'; //Autocomplete time delay setting\n\nimport { Key } from './key'; // API key\n\nimport { API_URL_PREDICT } from './Api'; //backend URL\n\nimport GoogleMapReact from 'google-map-react';\nimport axios from \"axios\";\nimport DatePicker from \"react-datepicker\"; // Default Dublin center\n\nlet cityCenter = {\n  lat: 53.347816,\n  lng: -6.259317\n};\n\nconst MyPositionMarker = ({\n  text\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 40\n  }\n}, text);\n\nconst Marker = ({\n  icon,\n  text\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(\"img\", {\n  style: {\n    height: '30px',\n    width: '30px'\n  },\n  alt: \"icon\",\n  src: icon,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 21,\n    columnNumber: 5\n  }\n}), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 5\n  }\n}, text)); // Map\n\n\nconst SimpleMap = props => {\n  const [myPosition, setMyPosition] = useState({\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  }); // Default state\n\n  let inputRef = useRef(null);\n  let inputRefTo = useRef(null);\n  const [startDate, setStartDate] = useState(new Date());\n  const [mapApiLoaded, setMapApiLoaded] = useState(false);\n  const [mapInstance, setMapInstance] = useState(null);\n  const [mapApi, setMapApi] = useState(null);\n\n  const apiHasLoaded = (map, maps) => {\n    setMapInstance(map);\n    setMapApi(maps);\n    setMapApiLoaded(true);\n  };\n\n  const [searchType, setSearchType] = useState(['transit_station']);\n\n  const SearchType = ({\n    text,\n    type\n  }) => {\n    return /*#__PURE__*/React.createElement(\"input\", {\n      type: \"button\",\n      value: text,\n      name: type,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 12\n      }\n    });\n  }; // Find bus stop\n\n\n  const [places, setPlaces] = useState([]);\n\n  const findLocation = () => {\n    if (mapApiLoaded) {\n      const service = new mapApi.places.PlacesService(mapInstance);\n      const request = {\n        location: myPosition,\n        radius: 1000,\n        type: searchType\n      };\n      service.nearbySearch(request, (results, status) => {\n        if (status === mapApi.places.PlacesServiceStatus.OK) {\n          setPlaces(results);\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    findLocation();\n  }, [searchType, myPosition, mapApiLoaded]);\n\n  const handleCenterChange = ({\n    bound,\n    zoom,\n    center\n  }) => {\n    if (mapApiLoaded) {\n      setMyPosition({\n        // center.lat()  center.lng() catch the center in the screen\n        lat: mapInstance.center.lat(),\n        lng: mapInstance.center.lng()\n      });\n    }\n  };\n\n  const [inputText, setInputText] = useState('');\n\n  const handleInput = () => {\n    setInputText(inputRef.current.value);\n  };\n\n  const handleInputTo = () => {\n    setInputText(inputRefTo.current.value);\n  };\n\n  const handleSearchType = e => {\n    setSearchType(e.target.name);\n  }; // Change map type\n\n\n  const [mapType, setMapType] = useState('roadmap');\n\n  const handleMapTypeId = e => {\n    setMapType(e.target.name);\n  };\n\n  const [autocompleteResults, setAutocompleteResults] = useState([]);\n\n  const handleAutocomplete = () => {\n    if (mapApiLoaded) {\n      const serviceFrom = new mapApi.places.AutocompleteService();\n      const serviceTo = new mapApi.places.AutocompleteService();\n      const request = {\n        input: inputText\n      };\n      serviceFrom.getPlacePredictions(request, (results, status) => {\n        if (status === mapApi.places.PlacesServiceStatus.OK) {\n          setAutocompleteResults(results);\n        }\n      });\n      serviceTo.getPlacePredictions(request, (results, status) => {\n        if (status === mapApi.places.PlacesServiceStatus.OK) {\n          setAutocompleteResults(results);\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    handleAutocomplete();\n  }, [inputText]);\n  const [currentCenter, setCurrentCenter] = useState({\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  });\n\n  const handleClickToChangeMyPosition = e => {\n    const placeId = e.target.getAttribute('dataid');\n    const service = new mapApi.places.PlacesService(mapInstance);\n    const request = {\n      placeId: placeId,\n      fields: ['geometry']\n    };\n    service.getDetails(request, (result, status) => {\n      if (status === mapApi.places.PlacesServiceStatus.OK) {\n        const newPosition = {\n          lat: result.geometry.location.lat(),\n          lng: result.geometry.location.lng()\n        };\n        setCurrentCenter(newPosition); // change view\n\n        setMyPosition(newPosition); // change MyPosition\n\n        setAutocompleteResults([]); // Empty search list\n\n        inputRef.current.value = ''; // Empty <input>\n      }\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    axios({\n      method: 'post',\n      url: API_URL_PREDICT,\n      data: {\n        \"route\": 1,\n        \"time\": 2\n      }\n    }).then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '100vh',\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }, \"From: \", /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputRef,\n    type: \"text\",\n    onChange: debounce(handleInput, 500),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 15\n    }\n  }), \"To: \", /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputRefTo,\n    type: \"text\",\n    onChange: debounce(handleInputTo, 500),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(DatePicker, {\n    selected: startDate,\n    onChange: date => setStartDate(date),\n    showTimeSelect: true,\n    timeFormat: \"HH:mm\",\n    timeIntervals: 15,\n    timeCaption: \"time\",\n    dateFormat: \"MMMM d, yyyy h:mm aa\",\n    todayButton: \"Today\",\n    id: \"date-picker\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: handleClickToChangeMyPosition,\n    class: \"search\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  }, autocompleteResults && inputText && autocompleteResults.map(item => /*#__PURE__*/React.createElement(\"div\", {\n    key: item.id,\n    dataid: item.place_id,\n    id: \"search-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 13\n    }\n  }, item.description)))), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: handleSearchType,\n    class: \"search-place\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(SearchType, {\n    text: \"Bus Stop\",\n    type: \"transit_station\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(SearchType, {\n    text: \"Tourist Spot\",\n    type: \"tourist_attraction\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"map-type\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Satellite\",\n    onClick: handleMapTypeId,\n    name: \"hybrid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Road\",\n    onClick: handleMapTypeId,\n    name: \"roadmap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(GoogleMapReact, {\n    bootstrapURLKeys: {\n      key: Key,\n      libraries: ['places'] // Our api\n\n    } //hacky way to fix bug\n    ,\n    distanceToMouse: () => {},\n    center: currentCenter,\n    options: {\n      mapTypeId: mapType\n    },\n    onChange: handleCenterChange,\n    defaultCenter: props.center,\n    defaultZoom: props.zoom,\n    yesIWantToUseGoogleMapApiInternals: true //map: map itself, maps: google map object \n    ,\n    onGoogleApiLoaded: ({\n      map,\n      maps\n    }) => apiHasLoaded(map, maps),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(MyPositionMarker, {\n    lat: myPosition.lat,\n    lng: myPosition.lng,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }\n  }), places.map(item => /*#__PURE__*/React.createElement(Marker, {\n    icon: item.icon,\n    key: item.id,\n    lat: item.geometry.location.lat(),\n    lng: item.geometry.location.lng(),\n    text: item.name,\n    placeId: item.place_id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 11\n    }\n  }))));\n}; // Set defaultProps\n\n\nSimpleMap.defaultProps = {\n  center: {\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  },\n  zoom: 17\n}; // App\n\nfunction App() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(SimpleMap, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/pie_trick/Desktop/Semester3/Dublin-Bus-Time/frontend/src/App.js"],"names":["React","Component","useState","useEffect","useRef","Button","ButtonGroup","debounce","Key","API_URL_PREDICT","GoogleMapReact","axios","DatePicker","cityCenter","lat","lng","MyPositionMarker","text","Marker","icon","height","width","SimpleMap","props","myPosition","setMyPosition","inputRef","inputRefTo","startDate","setStartDate","Date","mapApiLoaded","setMapApiLoaded","mapInstance","setMapInstance","mapApi","setMapApi","apiHasLoaded","map","maps","searchType","setSearchType","SearchType","type","places","setPlaces","findLocation","service","PlacesService","request","location","radius","nearbySearch","results","status","PlacesServiceStatus","OK","handleCenterChange","bound","zoom","center","inputText","setInputText","handleInput","current","value","handleInputTo","handleSearchType","e","target","name","mapType","setMapType","handleMapTypeId","autocompleteResults","setAutocompleteResults","handleAutocomplete","serviceFrom","AutocompleteService","serviceTo","input","getPlacePredictions","currentCenter","setCurrentCenter","handleClickToChangeMyPosition","placeId","getAttribute","fields","getDetails","result","newPosition","geometry","handleSubmit","preventDefault","method","url","data","then","response","console","log","catch","error","date","item","id","place_id","description","key","libraries","mapTypeId","defaultProps","App"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect, useRef} from 'react';\nimport { Button, ButtonGroup } from \"reactstrap\";\nimport { debounce } from 'lodash' //Autocomplete time delay setting\nimport { Key } from './key' // API key\nimport {API_URL_PREDICT} from './Api' //backend URL\nimport GoogleMapReact from 'google-map-react';\nimport axios from \"axios\";\nimport DatePicker from \"react-datepicker\";\n\n// Default Dublin center\nlet cityCenter = {\n    lat: 53.347816,\n    lng: -6.259317\n};\n\n\nconst MyPositionMarker = ({ text }) => <div>{text}</div>;\n\nconst Marker = ({ icon, text }) => (\n  <div>\n    <img style={{ height: '30px', width: '30px' }} alt=\"icon\" src={icon} />\n    <div>{text}</div>\n  </div>\n)\n\n\n// Map\nconst SimpleMap = (props) => {\n  const [myPosition, setMyPosition] = useState({\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  })\n\n  // Default state\n  let inputRef = useRef(null);\n  let inputRefTo = useRef(null);\n\n  const [startDate, setStartDate] = useState(new Date());\n  \n  const [mapApiLoaded, setMapApiLoaded] = useState(false)\n  const [mapInstance, setMapInstance] = useState(null)\n  const [mapApi, setMapApi] = useState(null)\n  \n  const apiHasLoaded = (map, maps) => {\n    setMapInstance(map)\n    setMapApi(maps)\n    setMapApiLoaded(true)\n  };\n\n  const [searchType, setSearchType] = useState(['transit_station'])\n\n  const SearchType = ({ text, type }) => {\n    return <input type=\"button\" value={text} name={type} />\n  }\n  \n  // Find bus stop\n  const [places, setPlaces] = useState([])\n\n  const findLocation = () => {\n    if(mapApiLoaded) {\n      const service = new mapApi.places.PlacesService(mapInstance)\n\n      const request = {\n        location: myPosition,\n        radius: 1000,\n        type: searchType\n      };\n\n      service.nearbySearch(request, (results, status) => {\n        if(status === mapApi.places.PlacesServiceStatus.OK) {\n          setPlaces(results)\n        }\n      })\n    }\n  }\n\n  useEffect(() => {\n    findLocation()\n  }, [searchType, myPosition, mapApiLoaded])\n\n  const handleCenterChange = ({bound, zoom, center}) => {\n    if(mapApiLoaded) {\n      setMyPosition({\n        // center.lat()  center.lng() catch the center in the screen\n        lat: mapInstance.center.lat(),\n        lng: mapInstance.center.lng()\n      })\n    }\n  }\n\n  const [inputText, setInputText] = useState('')\n\n  const handleInput = () =>{\n    setInputText(inputRef.current.value)\n  }\n\n  const handleInputTo = () =>{\n    setInputText(inputRefTo.current.value)\n  }\n\n  const handleSearchType = e => {\n    setSearchType(e.target.name)\n  }\n  \n  // Change map type\n  const [mapType, setMapType] = useState('roadmap')\n\n  const handleMapTypeId = e => {\n    setMapType(e.target.name)\n  }\n\n  const [autocompleteResults, setAutocompleteResults] = useState([])\n  \n  const handleAutocomplete = () =>{\n    if (mapApiLoaded) {\n      const serviceFrom = new mapApi.places.AutocompleteService()\n      const serviceTo = new mapApi.places.AutocompleteService()\n      const request ={\n        input: inputText\n      }\n\n      serviceFrom.getPlacePredictions(request, (results, status, ) => {\n        if(status === mapApi.places.PlacesServiceStatus.OK){\n          setAutocompleteResults(results)\n        }\n      });\n\n      serviceTo.getPlacePredictions(request, (results, status, ) => {\n        if(status === mapApi.places.PlacesServiceStatus.OK){\n          setAutocompleteResults(results)\n        }\n      });\n\n    }\n  }\n  useEffect(()=>{\n    handleAutocomplete()\n  }, [inputText])\n\n  const [currentCenter, setCurrentCenter] = useState({\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  })\n\n  const handleClickToChangeMyPosition = e => {\n    const placeId = e.target.getAttribute('dataid')\n    const service = new mapApi.places.PlacesService(mapInstance)\n    const request = {\n      placeId: placeId,\n      fields: [\n        'geometry'\n      ]\n    }\n    service.getDetails(request, (result, status)=>{\n      if( status === mapApi.places.PlacesServiceStatus.OK) {\n        const newPosition = {\n          lat: result.geometry.location.lat(),\n          lng: result.geometry.location.lng()\n        }\n        setCurrentCenter(newPosition) // change view\n        setMyPosition(newPosition) // change MyPosition\n        setAutocompleteResults([]) // Empty search list\n        inputRef.current.value = '' // Empty <input>\n      }\n    })\n  }\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    axios({\n      method: 'post',\n      url: API_URL_PREDICT, \n      data: {\n      \"route\": 1,\n      \"time\" : 2\n      }\n    })\n    .then(function (response) {\n      console.log(response);\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n  }\n\n\n  return (\n      <div style={{ height: '100vh', width: '100%' }}>\n      \n      <div>\n        <div class=\"form\">\n        From: <input ref={inputRef} type=\"text\" onChange={ debounce(handleInput, 500) } />\n        To: <input ref={inputRefTo} type=\"text\" onChange={ debounce(handleInputTo, 500) } />\n        <DatePicker\n          selected={startDate}\n          onChange={date => setStartDate(date)}\n          showTimeSelect\n          timeFormat=\"HH:mm\"\n          timeIntervals={15}\n          timeCaption=\"time\"\n          dateFormat=\"MMMM d, yyyy h:mm aa\"\n          todayButton=\"Today\"\n          id=\"date-picker\"\n        />\n        {/* <Button onClick={handleSubmit}>Test</Button> */}\n        </div>\n        <div onClick={handleClickToChangeMyPosition} class=\"search\"> \n          {(autocompleteResults && inputText) &&\n          autocompleteResults.map(item=>(\n            <div key={item.id} dataid={item.place_id} id=\"search-list\">\n              {item.description}\n            </div>\n          ))}\n        </div>\n      </div>\n      \n      <div onClick={handleSearchType} class=\"search-place\">\n        <SearchType text=\"Bus Stop\" type=\"transit_station\" />\n        <SearchType text=\"Tourist Spot\" type=\"tourist_attraction\" />\n      </div>\n      <div class=\"map-type\">\n        <input type=\"button\" value=\"Satellite\" onClick={ handleMapTypeId } name=\"hybrid\" />\n        <input type=\"button\" value=\"Road\" onClick={ handleMapTypeId } name=\"roadmap\" />\n      </div>\n      <GoogleMapReact\n        bootstrapURLKeys={{\n          key: Key,\n          libraries:['places'] // Our api\n        }}\n        //hacky way to fix bug\n        distanceToMouse={()=>{}}\n\n        center={currentCenter}\n        options={{ mapTypeId: mapType }}\n        onChange={handleCenterChange}\n        defaultCenter={props.center}\n        defaultZoom={props.zoom}\n        yesIWantToUseGoogleMapApiInternals\n        //map: map itself, maps: google map object \n        onGoogleApiLoaded={({ map, maps }) => apiHasLoaded(map, maps)}\n        \n      >\n        <MyPositionMarker\n          lat={myPosition.lat}\n          lng={myPosition.lng}\n        />\n        {places.map(item=>(\n          <Marker\n            icon={item.icon}\n            key={item.id}\n            lat={item.geometry.location.lat()}\n            lng={item.geometry.location.lng()}\n            text={item.name}\n            placeId={item.place_id}\n          />\n        ))}\n      </GoogleMapReact>\n    </div>\n  );\n}\n\n// Set defaultProps\nSimpleMap.defaultProps = {\n  center: {\n    lat: cityCenter.lat,\n    lng: cityCenter.lng\n  },\n  zoom: 17\n};\n\n\n// App\nfunction App() {\n  return (\n    <div className=\"App\">\n      <SimpleMap />\n    </div>\n  );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}